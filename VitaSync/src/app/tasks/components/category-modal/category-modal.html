<div class="modal-backdrop" (click)="close()"></div>

<div class="modal">
  <div class="modal-header">
    <h2>Gestionar Categorías</h2>
    <button class="close-btn" (click)="close()">×</button>
  </div>

  <p class="modal-subtitle">Añade, edita o elimina tus categorías de tareas.</p>

  <div class="form-group">
    <label>Categorías Existentes</label>
    <ul class="category-list">
      <li *ngFor="let cat of categorias">
        <span class="color-indicator" [style.background]="cat.colorCategoria"></span>
        <span class="cat-name">{{ cat.nombreCategoria }}</span>
        <button (click)="edit(cat)" title="Editar"><i class="fa fa-pen"></i></button>
        <button (click)="delete(cat)" title="Eliminar"><i class="fa fa-trash"></i></button>
      </li>
    </ul>
  </div>

  <div class="form-group">
    <label>Añadir Nueva Categoría</label>
    <div class="add-category-row">
      <input type="text" placeholder="Nombre de la categoría" [(ngModel)]="nuevaCategoria.nombreCategoria" />
    </div>

    <div class="color-palette">
      <button *ngFor="let color of coloresPredefinidos"
              [style.background]="color"
              [class.selected]="nuevaCategoria.colorCategoria === color"
              (click)="seleccionarColor(color)"
              title="{{ color }}">
      </button>

      <div class="color-picker-wrapper" title="Seleccionar otro color">
        <i class="fa-solid fa-eye-dropper color-icon"></i>
        <input type="color"
              [(ngModel)]="nuevaCategoria.colorCategoria" />
      </div>
    </div>

    <div class="form-actions">
      <button (click)="addOrUpdate()" class="btn-primary">
        {{ editandoCategoriaId ? 'Actualizar Categoría' : 'Añadir Categoría' }}
      </button>
      <button *ngIf="editandoCategoriaId" (click)="resetForm()" class="btn-secondary">
        Cancelar
      </button>
    </div>
  </div>

</div>
